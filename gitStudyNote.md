# 本地版本控制系统(git)学习笔记

## 前言

这篇笔记来源于廖雪峰个人官方网的 `git教程`  。是在别人的总经出来的使用经验上再次学习所做的笔记，非git官方原始教程的学习笔记，所以可能存在：不全面、理解错误以及因git版块迭代代来的相关问题。

## 一、关于git

### 1、git简介

git 是目前世界上最先进的分布式版本控制系统（没有之一）——摘自廖雪峰官网。

git 可以帮我们自动记录每次文件的改动， 还可以让同事协编辑。其作用就是：

1. 不需再去手动管理堆不断修改变化的文件；
2. 也不需要将文件传来传去；
3. 如果 想查看某次改动的内容，只需要这个系统软件调阅即可；

### 2、git的诞生

1991年1inus创建了开源的Linux开源系统，从此Linux不断发展，已经成为全世界最大的服务器系统软件了；

Linux的壮大是靠全世界热心的志愿者参与的，众多的分布在世界各地的参与者，使代码管理成为了一个问题：

- 一开始，世界各地的志愿者把源代码文件通过不同的方式发送给Linus，由其本人通过手工方式对代码进行合并处理，这种方式一至持续到2002年。 **需要注意的是，当时已经有版本控制系统，比如：CVS 、SVN 等，但这些版本控制系统，但由于这些集中式版本控制系统运行速度慢，而且必须联网才能使用，所以遭到了Linus的坚决反对。尽管当时也有一些分布式的版本控制系统软件，但由于是付费的，与Linus的开源精神不相符，所以也没有使用**
- 经过10年的发展，Linux系统已经非常庞大了，linus很难通过手动方式管理来自世界各地的代码了，同时，这种方式也带来了众多志愿者的强烈不满。所以他不得不选择了一个商业的版本控制系统——BitKeeper.出于人道主义，BitKeeper的东家BitMover公司授权Linux社区免费使用。
- 好景不长。到2005年，BitMover公司发现Linux团队中开发Samba的Andrew试图破解BitKeeper的协议，一怒之下收回了Linux社区的免费使用权；
- 不得已的情况下，Linus自已花了两周时间用C 语言写了一个分布式版本控制系统，这就是——**git!** 一个月之内，Linux的源码已经由git来进行管理了！ **牛！ 牛吧？ 真的很牛！**
- git 迅速成为最流行的版本控制系统。到2008年， github 官网上线了，它为开源项目**免费提供远端 git存储！**

### 3、集中式与分布版本控制系统的区别

#### #集中式版本控制系统

1. 必需一个中心服务器，所有的文件都保存在这个中心服务器上；
2. 协作团队成员的电脑必需与中心服务器联网；
3. 使用时需要先从服务器将需要编辑修改的文件下载到本地，修改完成之后再上传上去；
4. 存在上传下载的速度慢、团队成员必需联网待问题；

####　＃分布式版本控制系统

1. 分布式版本控制系统没有”中央服务器“，每个人的电脑上就有一个完整的版本库。这样就不需要联网了，第次修改都由本地的版本控制系统完成记录。
2. 当需要团队协作时，团队成员只需将各自修改的内容推送给对方，双方各自电脑上的版本控制系统就可以自动记录修改内容，形成相同的完整版本；
3. 不必担心文件的丢失问题，因为在团队成员中任一人的电脑上都可以找到完整的文件版本。　
4. 当然，对于Ｇit来说，它的优势就不单单是不用联系这么简单 了，它还拥有更强大的功能，比如：分支管理系统。



***简单地说,git 就是一个应用软件,要使用它,首先需要下载安装本应用软件.***



## 二、使用Git

### 1、如何安装git

​		现在，git 可以在Linux 、 Unix  、Mac 和 Windows这几大平台上正常运行了。针对不同的系统平台，有不同的安装方法：

#### 1）在Linux 系统上安装 git

如果你想在一台Linux 操作系统的电脑上安装git,可以：

- 在命令行工具中输入 `$git`,它会很友好地提示你是否已经安装了 git,并且告诉你安装方法，如下所示：

```
$ git
The program 'git' is currently not installed. You can install it by typing:
sudo apt-get install git
```

- 也就是说，如果你在命令行工具中输入 `sudo apt-get install git`  指令，碰巧你使用的是Debian 或 Ubuntu 版本的 Linux系统，这一条指令就可以成功安装 git; 
- 如果不能成功安装，有可能是你在使用更老版本的Debian 或 Ubuntu ，此时，只需将指令修改为： `sudo apt-get install git-core`  即可；
- 如果使用  `sudo apt-get install git-core`  指令仍然不能正常安装 git, 那说明你在使用其它版本的 Linux 操作系统。此时，也不要怕，只需从 git 官网下载源码，然后输入几个指令即可：./config`，`make`，`sudo make install

#### 2）在Mac OS X上安装Git

​	在Mac 上安装 git 有两种方法：

1. ​	一是安装 `homebrew`   ,然后通过  `homebrew` 安装 git, 具体方法请参考homebrew的文档：http://brew.sh/。
2. 第二种方法也是推荐方法，就是直接从 `AppStore`  安装  `Xcode`  .因为 `Xcode`  集成了 git ,但不是默认安装。需要运行Xcode，选择菜单“Xcode”->“Preferences”，在弹出窗口中找到“Downloads”，选择“Command Line Tools”，点“Install”就可以完成安装了。

####  3）在Windows上安装Git

​	在Windows系统上使用 git ,可以从 Git 官网上直接[下载安装程序](https://git-scm.com/downloads) ，然后按照提示选择相应的选项进行安装即可。

安装完成后，在开始菜单里找到” git “ -> "git-bash",点击后，在桌面上蹦出一个类似命令行工具的玩意儿，就说明巡装成功了！（如下图：）

![](F:\开发练习\git\images\gitbash.png)

**因为Git是分布式版本控制系统，所以，每个机器都必须自报家门：你的名字和Email地址。**

所以，安装完成后，需要进行基本的配置，才可以使用：

```html
$ git config -global user.name "your name"
$ git config -global user.email "email@example.com"
```



### ２、创建版本库(初始化仓库)

什么是版本库呢？顾名思义就是版本仓库。英文名是 `repository`  .可以简单地理解为一个文件夹，在这个文件夹里所有的文件都可以被 git 管理起来，每个文件的修改、删除，Git都能跟踪，以便任何时刻都可以追踪历史，或者在将来某个时刻可以“还原”。

**请注意:所有的版本控制系统，其实只能跟踪文本文件的改动，比如TXT文件，网页，所有的程序代码等等，Git也不例外。**

**下方所有的描述均是基于windows操作系统的操作使用**

那如何创建版本库呢？

1. 选择一个合适的地方，创建 git 目录(仓库repository)

   在命令行工具栏中,使用cd命令,运行到指定的目录,然后使用 `git init`  命令从而初始化git仓库:

```html
PS F:\开发练习\vuetest> cd f:\开发练习\git
PS F:\开发练习\git>
Reinitialized existing Git repository in F:/开发练习/git/.git/
```

**当使用 `git init`  指令初始化 git 仓库成功后,在命令行工具中会提示在所创建的目下多了一下 `/.git` 的目录**

### 3、添加文件到 git 仓库

​		添加文件到 git 仓库只需要两步：

​		**第一步**：使用 git  add  指令

​					使用 `git add` 指令时，第一，要在其后注明要添加到仓库的文件名，第二，可以反复使用 `git add` 			指令，将多个文件先都添加到暂存区。 

​		**第二步**：使用 git   commit 指令

​					使用 `git commit`  （提交）指令时，第一，它可以一次性将暂存区中的文件全部提交到git仓库，第			二，在使用提交指令时，最好辅以 `-m  "描述说明"`  ，这样方便以后找到本次提交的内容。

### 4、查看当前状态

​		当我们向git仓库添加或提交内容后都可以通过  `git status`  指令来查询当前暂存区及工作区的状态。

​		如查已有内容添加到暂存区，也就是说仅仅使用了 `git add` 指令后，此时暂存区有文件，所以，使用 `git status`  指令来查询状态时，它会告诉我们：在主分支上有更改的内容需要提交，并且使用绿色字体告知我们当前暂存区被变更的文件有哪些。如下图：

![](F:\开发练习\git\images\1.png)

​		如果使用 `git commit`  指令对暂存区的内容已经提交完成，那么再次使用 `git status` 查看状态时，他会提醒我们：在主分支上没有什么可提交，工作树上很干净。如下图：	![](F:\开发练习\git\images\2.png)

### 5、时光穿梭机

经过几次修改后，我们可以查看所有的修改提交记录，当然也可以回退到之前的某个版本。怎么操作呢？

我们知道了使用 `git diff`  可以查看当前工作区的文件内容与 git 仓库中已保存版本的不同;

使用 `git status` 可以查看工作区的文件状态,如果想要实现回退到之前的某个版本该怎么操作呢?

#### 1) 版本回退

`git reset --hard HEAD^`    回退到上一个版本;

`git reset --hard HEAD^^`    回退到上上个版本;

`git reset --hard HEAD~41`      向上回退到第41个版本;

`git reset --hard commit_id`   回退到指定 `commit_id`  的版本.

#### 2)查看命令历史

`git reflog`    查看命令历史记录

#### 3)工作区和暂存区

工作区上指本地可以看到的目录(文件夹),而暂存区是 git 为我们自动创建的版本库中的关键位置区域. 

![](F:\开发练习\git\images\git1.png)

当执行 `git add` 指令时,git自动将工作区的文件或改动添加到版本库中的暂存区:

![](F:\开发练习\git\images\git2.png)

当执行 `git commit` 指令时, git 自动将暂存区的内容提交到版本库中的分支管理内.

![](F:\开发练习\git\images\git3.png)

#### 4)管理修改

这里只需声明一点:那就是,每次修改完成后,只能通过 `git add`  指令添加到暂存区内的修改才可以被  `git commit`  指令将修改内容提交到 git 仓库的 commit 中.

例如:  先做了修改, 并使用 `git add` 指令将此修改添加到了暂存区,然后就做了修改,但第二次修改后没有使用  `git add`  指令将第二次修改的内容添加到暂存区.紧接着使用了 `git commit`  指令.

上例操用的结果就是:   只能将第一次修改的内容提交到 git 仓库的  commit   中.而第二次的修改并没有被提交; 

#### 5)撤销修改

想要撤销修改,根据你修改完后的状态不同,可以有不同的撤销方法:

1. 如要您只是完成了修改就后悔了,也就是说你的修改内容还只是在工作区,还没有使用 `git add`  指令将期添加到暂区,这时候,非常好办,

   只需使用 `git checkout --file`  指令  或者  `git restore <file>`就可以撤销你所有的修改;

   **请注意: 此时使用 `git checkout `  指令时,一定要带上 `--file`   否则,该指令将执行   *切换到另一个分支*   的命令  **

2. 如果你完成修改后已经使用 `git add`  指令将修改内容添加到了暂存区,也不要惊慌,还好办,只不过多一步操作而已

   第一步,先把它从暂存区中给撤回到工作区: 使用 `git reset HEAD <file>`指令 或者 `git restore --staged <file>`; 

   第二步,使用 `git checkout --file `  指令或 `git restore <file>`,将工作区内存在的修改内容给撤销掉;

   **请注意:  `git reset `  指令既可以回退版本,也可以撤销暂存区中的内容,当在本指令中使用 `HEAD`  表时撤销的是最新版本. **

3. 如果你已使用 `git add `  `git commit`  将修改内容已经提交到了git仓库的分支中,但是,还没有上传到远端仓库,也还有办法:

   就是使用 **版本回退**  功能, 只将你认为可以版本上传到远端仓库或分享给他人,你认为不合的版本一直保存在你自己电脑中的本地仓库中(*没人知道的*);

4. 如果你已经将修改内容提交到了远端仓库,那就……没办法了……



​			**其实，在终端中，使用 `git status` 指令时，它总是能够提醒你 *接下来你可以使用什么指令进行什么样的操作* **

 	例如：只在工作区修改完成后查询状态：

​	![](F:\开发练习\git\images\changestatus.png)

   添加到暂存区之后：

![](F:\开发练习\git\images\addchange.png)

####  6) 删除文件

想要删除文件有三种可能:

一是尚未提交到版本库的文件,直接在工作区删除该文件就可以了,此时你的行为操作和版本库没有任何关系;  **请注意,此时,因为该文件从未提交到版本库,也就是说从来没有对该文件做过任何备份保存,所以删除后就再也无法恢复了!**

二是已经提交到暂存区的文件.如查想要删除已经提交到暂存区的文件,也简单 ,只需使用 `git restore <file>`  指令或者 `git checkout --file`  指令将其从暂存区撤销,然后在工作区直接删除即可;

三是如果文件已经提交到了版本库的分支中,那也可以,只需要使用  `git rm  <file>`  指令将文件删除 即可.  **请注意,执行完删除操作后,还允许你后悔,这就意味着执行完删除操作后,你可以有两种做法:** 

1\ 确定要删除:  如果你确定要删除 ,只需进行一次 `commit`  提交即可;  例:

![](F:\开发练习\git\images\rmfile.png)

![](F:\开发练习\git\images\commitrm.png)

2\  如果执行完 `git rm <file>`  命令后,你又后悔了,觉得还是不删除为好,想把删除掉的文件再找回来,有办法:只需再执行一次 `git checkout --file`  指令即可"一键恢复"



### 6 、远程仓库

***当下，最便捷易用的远程仓库就属 git-hub 了！***

所在要想使用远程仓库需要两步：

第一步：在 git-hub 官网上注册帐号；

第二步：在你的电脑上通过 命令行工具执行  ` ssh-keygen -t rsa -C "youremail@example.com"` 指令，即可生成本机的密钥，请注意，生成的密钥有 “私钥”  和 “ 公钥”  只需要将  “ 公钥”  添加到git-hub帐号里的 `SSH KEYS`  里即可。 